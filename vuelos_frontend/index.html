<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vuelos App — Inicio</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <header class="header card">
      <h1>Vuelos App</h1>
      <p class="small">Microservicios: usuarios (auth), vuelos y reservas. Frontend simple HTML/CSS/JS.</p>
      <div class="topbar">
        <button class="btn ghost" id="btnLogin">Iniciar sesión</button>
        <button class="btn" id="btnAdminUsers">Admin — Usuarios</button>
        <button class="btn" id="btnAdminFlights">Admin — Vuelos</button>
        <button class="btn" id="btnGestor">Gestor — Reservas</button>
      </div>
    </header>

    <main>
      <section class="card">
        <h2>Bienvenido</h2>
        <p>Usa el botón <strong>Iniciar sesión</strong> para acceder. Si ya iniciaste sesión, serás redirigido automáticamente según tu rol.</p>
        <div class="notice small">
          Usuario de prueba (si los seed están activos): <br>
          <strong>admin@system.com</strong> / <strong>admin123</strong>
        </div>
      </section>

      <section class="card">
        <h3>Atajos</h3>
        <div class="grid cols-2">
          <div>
            <h4>Administrador</h4>
            <p>Gestiona usuarios, naves y vuelos.</p>
            <button class="btn primary" id="gotoAdminUsers">Ir a Usuarios</button>
            <button class="btn primary" id="gotoAdminFlights">Ir a Vuelos</button>
          </div>
          <div>
            <h4>Gestor</h4>
            <p>Gestiona reservas y consultas de vuelos.</p>
            <button class="btn primary" id="gotoGestor">Ir a Reservas</button>
          </div>
        </div>
      </section>
    </main>

    <footer class="card small">
      <div>Desarrollado con Slim + Eloquent + JWT · Frontend estático</div>
    </footer>
  </div>

<script src="js/api.js"></script>
<script src="js/auth.js"></script>
<script>
  // redirección automática si ya hay sesión
  (function(){
    const token = localStorage.getItem('jwt_token');
    const role = localStorage.getItem('user_role');

    // si hay token y rol, redirigir al panel correspondiente
    if (token && role) {
      if (role === 'administrador') {
        window.location.href = 'admin_users.html';
        return;
      }
      if (role === 'gestor') {
        window.location.href = 'gestor_reservas.html';
        return;
      }
    }

    // botones
    document.getElementById('btnLogin').addEventListener('click', ()=> location.href = 'login.html');
    document.getElementById('btnAdminUsers').addEventListener('click', ()=> location.href = 'admin_users.html');
    document.getElementById('btnAdminFlights').addEventListener('click', ()=> location.href = 'admin_flights.html');
    document.getElementById('btnGestor').addEventListener('click', ()=> location.href = 'gestor_reservas.html');

    // atajos
    document.getElementById('gotoAdminUsers').addEventListener('click', ()=> location.href = 'admin_users.html');
    document.getElementById('gotoAdminFlights').addEventListener('click', ()=> location.href = 'admin_flights.html');
    document.getElementById('gotoGestor').addEventListener('click', ()=> location.href = 'gestor_reservas.html');
  })();
</script>
</body>
</html>